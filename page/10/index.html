<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>公孙二狗</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="大圣，此去欲何？踏南天，碎凌霄。若一去不回……？便一去不回！">
<meta property="og:type" content="website">
<meta property="og:title" content="公孙二狗">
<meta property="og:url" content="http://xtuer.github.io/page/10/index.html">
<meta property="og:site_name" content="公孙二狗">
<meta property="og:description" content="大圣，此去欲何？踏南天，碎凌霄。若一去不回……？便一去不回！">
<meta property="og:locale">
<meta property="article:author" content="公孙二狗">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="公孙二狗" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/dog.png">
  
  
<link rel="stylesheet" href="/css/style.css">


  <!-- <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"> -->
  <!-- <script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script> -->
  <!-- <script src="//cdn.bootcss.com/require.js/2.3.6/require.min.js"></script> -->
  <link href="/css/fonts/font-awesome.min.css" rel="stylesheet">

  <!-- mermaid.js (8.7.0) 需要在 require.js 前面加载 -->
  <script src='/js/mermaid.min.js'></script>
  <script src="/js/jquery.min.js"></script>
  <script src="/js/require.min.js"></script>
  <script src="/js/main.js"></script>

  <!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> -->
  <!-- <script src="https://hm.baidu.com/hm.js?22778d8041aa1437b11529a3e87a0a12"></script> -->
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
    <div id="container">
        <div class="left-col">
            <div class="content-table">Content Table</div>
            <div class="overlay"></div>

<ul class="menu">
    <!-- <li class="item"><a href="javascript:void(0)" id="baidu-search-button">百度搜索</a></li> -->
    <!-- <li class="item"><a href="javascript:void(0)" id="google-search-button">谷歌搜索</a></li> -->
    <!-- <li class="item non-index-item"><a href="javascript:void(0)" id="show-toc-button">显示目录</a></li> -->
</ul>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img src="/img/dog.png" class="js-avatar" style="width: 100%;height: 100%;opacity: 1;">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/all/">公孙二狗</a></h1>
		</hgroup>
		<p style=" margin-bottom: 10px;margin-top: -5px;">
			<a style="color: gray;" target="_blank" rel="noopener" href="http://wpa.qq.com/msgrd?v=3&uin=26664141&site=qq&menu=yes">QQ: 26664141</a>
		</p>

		
		<p class="header-subtitle">大圣，此去欲何？踏南天，碎凌霄。若一去不回……？便一去不回！</p>
		
		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-ribbon" data-idx="1">
							<div class="ribbon"></div>
						</div>
						<div class="icon-wrap icon-house hide" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>

				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Tags</li>
						<li>Menu</li>
						
						<li>Links</li>
						
						
						<li>About</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				
				<section class="switch-part switch-part1">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Ajax/" style="font-size: 10px;">Ajax</a> <a href="/tags/Cas/" style="font-size: 11.67px;">Cas</a> <a href="/tags/DB/" style="font-size: 15px;">DB</a> <a href="/tags/FE/" style="font-size: 20px;">FE</a> <a href="/tags/Go/" style="font-size: 10px;">Go</a> <a href="/tags/Gradle/" style="font-size: 13.89px;">Gradle</a> <a href="/tags/Hexo/" style="font-size: 12.22px;">Hexo</a> <a href="/tags/Index/" style="font-size: 12.78px;">Index</a> <a href="/tags/Java/" style="font-size: 19.44px;">Java</a> <a href="/tags/Mac/" style="font-size: 17.78px;">Mac</a> <a href="/tags/Misc/" style="font-size: 17.22px;">Misc</a> <a href="/tags/PHP/" style="font-size: 10.56px;">PHP</a> <a href="/tags/Qt/" style="font-size: 18.33px;">Qt</a> <a href="/tags/QtBook/" style="font-size: 18.89px;">QtBook</a> <a href="/tags/Redis/" style="font-size: 10.56px;">Redis</a> <a href="/tags/SemanticUi/" style="font-size: 13.89px;">SemanticUi</a> <a href="/tags/Spring/" style="font-size: 11.11px;">Spring</a> <a href="/tags/SpringBoot/" style="font-size: 13.33px;">SpringBoot</a> <a href="/tags/SpringCore/" style="font-size: 15.56px;">SpringCore</a> <a href="/tags/SpringMVC/" style="font-size: 14.44px;">SpringMVC</a> <a href="/tags/SpringSecurity/" style="font-size: 15px;">SpringSecurity</a> <a href="/tags/SpringWeb/" style="font-size: 16.67px;">SpringWeb</a> <a href="/tags/Util/" style="font-size: 16.67px;">Util</a> <a href="/tags/Vue/" style="font-size: 16.11px;">Vue</a> <a href="/tags/zTree/" style="font-size: 11.11px;">zTree</a>
                    </div>
                    <script>

                    </script>
				</section>
				

				<section class="switch-part switch-part2">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
					</nav>
				</section>

				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://loadship.cn">小鱼人</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://qtnull.com/">千古</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">吞风吻雨葬落日未曾彷徨，欺山赶海践雪径也未绝望，拈花把酒偏折煞世人情狂，凭这两眼与百臂或千手不能防，天阔阔雪漫漫共谁同航，这沙滚滚水皱皱笑着浪荡，贪欢一晌偏教那女儿情长埋葬。</div>
				</section>
				
			</div>
		</div>
        <div class="links-area" style="margin-top: 10px;">
            <a href="/html/tools">收藏夹 |</a>
            <a href="/qtbook">Qt 杂谈 |</a>
            <a href="/html/vue-in-action">Vue 实践</a>
            <a href="/html/spring-boot">Spring Boot |</a>
            <a href="/spring-web-index">Java Web 开发</a>
        </div>
	</header>
</div>

<script>
    $(document).ready(function() {
        // Baidu 搜索
        // $('#baidu-search-button').click(function(event) {
        //     layer.prompt({title: false, formType: 0, closeBtn: 0, maxlength: 140}, function(text, index) {
        //         layer.close(index);
        //         window.open('https://www.baidu.com/s?wd=site:qtdebug.com+'+text);
        //     });
        // });
        //
        // // Google 搜索
        // $('#google-search-button').click(function(event) {
        //     layer.prompt({title: false, formType: 0, closeBtn: 0, maxlength: 140}, function(text, index) {
        //         layer.close(index);
        //         window.open('https://www.google.com/?#q=site:qtdebug.com+'+text);
        //     });
        // });
    });

    function resetTags() {
		var tags = $(".tagcloud a");
		tags.css({"font-size": "12px"});
		for(var i=0,len=tags.length; i<len; i++){
			var num = tags.eq(i).html().length % 5 +1;
			tags[i].className = "";
			tags.eq(i).addClass("color"+num);
		}
    }

    resetTags();
</script>

        </div>
        <div class="mid-col">
            <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img src="/img/dog.png" class="js-avatar" style="width: 100%;height: 100%;opacity: 1;">
			
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>

            <div class="body-wrap">
  
    <!-- 生成目录 -->


<article id="post-misc-distributed-lock" class="article article-type-post" itemscope itemprop="blogPost">
    <!--  -->

    
        <div class="article-meta">
            <a href="/misc-distributed-lock/" class="article-date">
  	<!-- <time datetime="2018-10-16T09:26:54.000Z" itemprop="datePublished">2018-10-16</time> -->
    2018-10-16
</a>

        </div>
    

    
        <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/misc-distributed-lock/">ZooKeeper 实现分布式锁</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
        
            <p>在 Java 中使用 ZooKeeper 实现分布式锁可按以下几步进行:</p>
<ol>
<li>下载安装 <a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/apache/zookeeper/zookeeper-3.4.13/">ZooKeeper 3.4.13</a>，参考 <a target="_blank" rel="noopener" href="https://qtdebug.com/misc-zookeeper/">本机安装 ZooKeeper 集群</a> 进行安装单机版 ZooKeeper，有必要的时候再安装集群</li>
<li>引入 Curator 的依赖，它实现了 ZooKeeper 的分布式锁</li>
<li>Java 测试程序</li>
</ol>
<h2 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h2><p>参考 <a target="_blank" rel="noopener" href="https://qtdebug.com/misc-zookeeper/">本机安装 ZooKeeper 集群</a></p>
<h2 id="引入-Curator-的依赖"><a href="#引入-Curator-的依赖" class="headerlink" title="引入 Curator 的依赖"></a>引入 Curator 的依赖</h2><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compile <span class="attr">group:</span> <span class="string">&#x27;org.apache.curator&#x27;</span>, <span class="attr">name:</span> <span class="string">&#x27;curator-recipes&#x27;</span>, <span class="attr">version:</span> <span class="string">&#x27;2.12.0&#x27;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意: Curator 和 ZooKeeper 的版本需要对应，否则会报错</p>
<p><code>Curator 2.x.x</code>: compatible with both ZooKeeper 3.4.x and ZooKeeper 3.5.x</p>
<p><code>Curator 3.x.x</code>: compatible only with ZooKeeper 3.5.x and includes support for new features such as dynamic reconfiguration, etc.</p>
</blockquote>
<h2 id="Java-测试程序"><a href="#Java-测试程序" class="headerlink" title="Java 测试程序"></a>Java 测试程序</h2><p>官方文档: <a target="_blank" rel="noopener" href="http://curator.apache.org/getting-started.html%EF%BC%8C%E5%85%88%E6%BC%94%E7%A4%BA">http://curator.apache.org/getting-started.html，先演示</a> Curator 连接 ZooKeeper 并使用分布式锁 InterProcessMutex:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testDistributedLock</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">// [1] This will create a connection to a ZooKeeper cluster using default values.</span></span><br><span class="line">    <span class="comment">// The only thing that you need to specify is the retry policy. For most cases, you should use:</span></span><br><span class="line">    CuratorFramework client = CuratorFrameworkFactory.newClient(<span class="string">&quot;127.0.0.1:2181&quot;</span>, <span class="keyword">new</span> ExponentialBackoffRetry(<span class="number">10000</span>, <span class="number">3</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// [2] The client must be started (and closed when no longer needed).</span></span><br><span class="line">    client.start();</span><br><span class="line"></span><br><span class="line">    InterProcessMutex lock = <span class="keyword">new</span> InterProcessMutex(client, <span class="string">&quot;/ebag/lock&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// [3] 获取全局锁</span></span><br><span class="line">    <span class="keyword">if</span> (lock.acquire(<span class="number">10</span>, TimeUnit.SECONDS)) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// [4] 业务代码</span></span><br><span class="line">            System.out.println(<span class="string">&quot;Do something&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// [5] 释放全局锁</span></span><br><span class="line">            lock.release();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// [6] Close the client</span></span><br><span class="line">    client.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>多线程测试分布式锁，结果 sn 是按顺序输出的，说明锁生效了:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testZooKeeperThread</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    CuratorFramework client = CuratorFrameworkFactory.newClient(<span class="string">&quot;127.0.0.1:2181&quot;</span>, <span class="keyword">new</span> ExponentialBackoffRetry(<span class="number">10000</span>, <span class="number">3</span>));</span><br><span class="line">    client.start();</span><br><span class="line">    List&lt;Thread&gt; threads = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; ++i) &#123;</span><br><span class="line">        threads.add(<span class="keyword">new</span> Thread(<span class="keyword">new</span> ZooKeeperRunnable(client, <span class="string">&quot;/ebag/lock&quot;</span>)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Thread thread : threads) &#123;</span><br><span class="line">        thread.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// client.close();</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ZooKeeperRunnable</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> sn = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> InterProcessMutex lock;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ZooKeeperRunnable</span><span class="params">(CuratorFramework client, String path)</span> </span>&#123;</span><br><span class="line">        lock = <span class="keyword">new</span> InterProcessMutex(client, path);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 获取全局锁</span></span><br><span class="line">            <span class="keyword">if</span> (lock.acquire(<span class="number">10</span>, TimeUnit.SECONDS)) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">// Thread.sleep(100);</span></span><br><span class="line">                    sn++;</span><br><span class="line">                    System.out.println(sn);</span><br><span class="line">                &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                    <span class="comment">// 释放全局锁</span></span><br><span class="line">                    lock.release();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>提示: 上面的多线程是同一个 JVM 中的，可以很简单的修改为在多个 JVM 中运行，演示真正的分布式锁的效果，共享资源 sn 可以保存到 Redis，数据库等中。</p>
</blockquote>
<h2 id="ZooKeeper-常用命令"><a href="#ZooKeeper-常用命令" class="headerlink" title="ZooKeeper 常用命令"></a>ZooKeeper 常用命令</h2><ul>
<li>创建: create path data: <code>create /foo &quot;Hello&quot;</code></li>
<li>修改: set path data: <code>set /foo &quot;Vox&quot;</code></li>
<li>获取: get path: <code>get /foo</code></li>
<li>删除: delete path: <code>delete /foo</code></li>
<li>查看: ls path: <code>ls /foo</code></li>
</ul>

        
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Misc/" rel="tag">Misc</a></li></ul>
	</div>


      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  

</article>





  
    <!-- 生成目录 -->


<article id="post-mac-centos7-libreoffice" class="article article-type-post" itemscope itemprop="blogPost">
    <!--  -->

    
        <div class="article-meta">
            <a href="/mac-centos7-libreoffice/" class="article-date">
  	<!-- <time datetime="2018-07-22T06:23:27.000Z" itemprop="datePublished">2018-07-22</time> -->
    2018-07-22
</a>

        </div>
    

    
        <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/mac-centos7-libreoffice/">CentOS7 安装 LibreOffice</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
        
            <p>使用 CentOS7 无界面版本作为服务器的操作系统，在里面安装 LibreOffice 用于转换各种文档到 PDF，LibreOffice 的安装步骤如下:</p>
<ol>
<li><p>下载:</p>
<ol>
<li>访问 <a target="_blank" rel="noopener" href="https://www.libreoffice.org/download/download/">https://www.libreoffice.org/download/download/</a></li>
<li>选择 <strong>Linux x86_64(rpm)</strong> 的版本</li>
<li>下载得到 LibreOffice_6.0.5_Linux_x86-64_rpm.tar.gz (目前最新版为 6.0.5)</li>
</ol>
</li>
<li><p>安装:</p>
<ol>
<li>删除: 在安装之前，先删除已经安装的 LibreOffice: <code>yum remove libreoffice*</code></li>
<li>解压: <code>tar -xvf LibreOffice_6.0.5_Linux_x86-64_rpm.tar.gz</code></li>
<li>安装:<ol>
<li><code>cd LibreOffice_6.0.5.2_Linux_x86-64_rpm/RPMS</code></li>
<li><code>yum localinstall *.rpm</code></li>
</ol>
</li>
<li>查看:<ol>
<li><code>which libreoffice6.0</code> 看到路径为 <strong>/usr/bin/libreoffice6.0</strong></li>
<li><code>ll /usr/bin/libreoffice6.0</code> 得到 <strong>/opt/libreoffice6.0/program/soffice</strong>，说明安装到了 <strong>/opt/libreoffice6.0</strong></li>
</ol>
</li>
</ol>
</li>
<li><p>依赖:</p>
<p>执行 <code>libreoffice6.0</code> 可能会提示库文件找不到，如 libcairo.so.2，libcups.so.2，libSM.so.6 等，执行下面几条命令安装需要的库:</p>
<ul>
<li><code>yum install cairo -y</code></li>
<li><code>yum install cups-libs -y</code></li>
<li><code>yum install libSM -y</code> </li>
</ul>
</li>
</ol>
<p>安装 LibreOffice 可参考 <a target="_blank" rel="noopener" href="https://www.tecmint.com/install-libreoffice-on-rhel-centos-fedora-debian-ubuntu-linux-mint/">https://www.tecmint.com/install-libreoffice-on-rhel-centos-fedora-debian-ubuntu-linux-mint/</a>。</p>
<p>Java 中可使用 <a target="_blank" rel="noopener" href="https://github.com/sbraconnier/jodconverter">JODConverter</a> 调用 LibreOffice 进行文件格式转换，可参考 <a target="_blank" rel="noopener" href="https://qtdebug.com/office-to-pdf-html/">Office 文档转为 PDF 和 HTML</a>。</p>

        
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mac/" rel="tag">Mac</a></li></ul>
	</div>


      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  

</article>





  
    <!-- 生成目录 -->


<article id="post-qtbook-custom-widget-lineedit-with-button" class="article article-type-post" itemscope itemprop="blogPost">
    <!--  -->

    
        <div class="article-meta">
            <a href="/qtbook-custom-widget-lineedit-with-button/" class="article-date">
  	<!-- <time datetime="2018-07-15T06:16:02.000Z" itemprop="datePublished">2018-07-15</time> -->
    2018-07-15
</a>

        </div>
    

    
        <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/qtbook-custom-widget-lineedit-with-button/">QLineEdit 中增加按钮</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
        
            <p>下图为 Safari 的地址栏，在输入框右边有一个刷新按钮:</p>
<p><img src="../img/qtbook/custom-widget/lineedit-with-button-1.png"></p>
<p>在输入框中增加按钮的设计是比较常见的，例如 Chrome 的地址栏、Firefox 的搜索框、Tim 的搜索框等，这种控件 Qt 没有提供，那应该怎么实现呢？下面提供 2 种思路:</p>
<ul>
<li>QLineEdit + QPushButton 使用 QHBoxLayout 布局到一个 QWidget 中，去掉 QLineEdit 得到焦点时的高亮效果，此时应该高亮它的父控件，失去焦点时取消它的父控件的高亮效果</li>
<li>QLineEdit 作为一个普通的 QWidget，也就是它能够使用 QLayout 把 QPushButton 作为子控件布局到它里面</li>
</ul>
<p>思路有了，第一种方式需要写很多代码进行控制，实现比较麻烦，下面只介绍第二种思路的实现。
        
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/QtBook/" rel="tag">QtBook</a></li></ul>
	</div>


      

      
        <p class="article-more-link">
          <a  href="/qtbook-custom-widget-lineedit-with-button/#more">阅读全文</a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  

</article>





  
    <!-- 生成目录 -->


<article id="post-qtbook-custom-widget-model-view-programming" class="article article-type-post" itemscope itemprop="blogPost">
    <!--  -->

    
        <div class="article-meta">
            <a href="/qtbook-custom-widget-model-view-programming/" class="article-date">
  	<!-- <time datetime="2018-07-09T12:06:48.000Z" itemprop="datePublished">2018-07-09</time> -->
    2018-07-09
</a>

        </div>
    

    
        <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/qtbook-custom-widget-model-view-programming/">模型视图编程</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
        
            <p>模型视图控制器 (MVC) 编程哪家讲的好，莫非是 Qt 帮助文档里的 Model/View Programming 了，可惜没有中文的，看过不少书里这方面的内容都是从这篇文档里抄的，我们就不要再花心思去创新了，直接翻译吧。</p>
<h2 id="模型视图编程简介"><a href="#模型视图编程简介" class="headerlink" title="模型视图编程简介"></a>模型视图编程简介</h2><p>Qt contains a set of item view classes that use a model/view architecture to manage the relationship between data and the way it is presented to the user. The separation of functionality introduced by this architecture gives developers greater flexibility to customize the presentation of items, and provides a standard model interface to allow a wide range of data sources to be used with existing item views. In this document, we give a brief introduction to the model/view paradigm, outline the concepts involved, and describe the architecture of the item view system. Each of the components in the architecture is explained, and examples are given that show how to use the classes provided.</p>
<p>Qt 中有几个 item view 的类 (视图)，使用<code>模型/视图</code>架构来管理和显示数据。这种分离的设计给开发者很高的灵活性，可以自定义数据的显示方式，视图通过模型提供的<code>标准接口</code>可以支持各种各样的数据源。本文涉及到模型/视图编程范例、简要的概念介绍以及描述视图系统的架构。每一个部分都会进行解释以及给出相关代码展示怎么使用。</p>
<h3 id="模型视图架构"><a href="#模型视图架构" class="headerlink" title="模型视图架构"></a>模型视图架构</h3><p>Model-View-Controller (MVC) is a design pattern originating from Smalltalk that is often used when building user interfaces. In Design Patterns, Gamma et al. write:</p>
<blockquote>
<p>MVC consists of three kinds of objects. The Model is the application object, the View is its screen presentation, and the Controller defines the way the user interface reacts to user input. Before MVC, user interface designs tended to lump these objects together. MVC decouples them to increase flexibility and reuse.</p>
</blockquote>
<p>Smalltalk 经常用来构建用户界面，模型-视图-控制器 (MVC) 这种设计模式就是从 Smalltalk 借鉴而来的。Gamma et al. 在设计模式中写到:</p>
<blockquote>
<p>MVC 由 3 种对象组成：Model 是应用的数据，View 显示数据，Controller 定义了用户界面对用户输入的响应。在使用 MVC 之前，用户界面的设计常常把这些对象耦合在一起。MVC 能够解耦它们从而提供更高的灵活性和重用性。</p>
</blockquote>
<div style="float: left"><img src="../img/qtbook/custom-widget/mvc/modelview-overview.png"></div>The model/view architecture
The model communicates with a source of data, providing an interface for the other components in the architecture. The nature of the communication depends on the type of data source, and the way the model is implemented.

<p>The view obtains model indexes from the model; these are references to items of data. By supplying model indexes to the model, the view can retrieve items of data from the data source.<br>In standard views, a delegate renders the items of data. When an item is edited, the delegate communicates with the model directly using model indexes.</p>
<div style="clear: both;">在模型/视图架构中，模型访问数据源中的数据，视图等控件通过模型提供的接口访问数据。通信的方式取决于数据源的类型和模型实现的方式。
数据由`数据项`组成，index 是数据项的引用，视图从模型中获得 index。视图通过访问模型中的 index 就能够访问数据源中的数据了。
在标准的视图中，`代理`用来渲染数据项。当数据项被编辑时，代理使用模型的 index 和模型交互。

<p>Generally, the model/view classes can be separated into the three groups described above: models, views, and delegates. Each of these components is defined by abstract classes that provide common interfaces and, in some cases, default implementations of features. Abstract classes are meant to be subclassed in order to provide the full set of functionality expected by other components; this also allows specialized components to be written.</p>
<p>Models, views, and delegates communicate with each other using signals and slots:</p>
<ul>
<li>Signals from the model inform the view about changes to the data held by the data source.</li>
<li>Signals from the view provide information about the user’s interaction with the items being displayed.</li>
<li>Signals from the delegate are used during editing to tell the model and view about the state of the editor.</li>
</ul>
<p>根据上面的介绍，模型/视图的类可以分为三类：模型、视图和代理，它们都有相应的抽象类提供通用的接口和某些功能的默认实现。抽象类就意味着要被其他类继承，根据需求提供对应的实现。</p>
<p>模型、视图和代理之间使用信号槽进行通信:</p>
<ul>
<li>数据源中的数据发生变化时，模型发射信号通知视图</li>
<li>用户和视图交互时视图会发射信号，例如点击 view item，信号的参数包含了被交互的 view item 的信息</li>
<li>编辑数据项的时候代理会把编辑器的状态通过信号通知模型和视图</li>
</ul>
<h3 id="模型"><a href="#模型" class="headerlink" title="模型"></a>模型</h3><p>All item models are based on the QAbstractItemModel class. This class defines an interface that is used by views and delegates to access data. The data itself does not have to be stored in the model; it can be held in a data structure or repository provided by a separate class, a file, a database, or some other application component.</p>
<p>The basic concepts surrounding models are presented in the section on Model Classes.</p>
<p>QAbstractItemModel provides an interface to data that is flexible enough to handle views that represent data in the form of tables, lists, and trees. However, when implementing new models for list and table-like data structures, the QAbstractListModel and QAbstractTableModel classes are better starting points because they provide appropriate default implementations of common functions. Each of these classes can be subclassed to provide models that support specialized kinds of lists and tables.</p>
<p>The process of subclassing models is discussed in the section on Creating New Models.</p>
<p>所有的 item 模型都是基于类 QAbstractItemModel 实现的。视图和代理使用 QAbstractItemModel 定义的接口访问数据。数据不一定是保存在模型中，也可以保存在其他类、文件、数据库或者其他应用中。</p>
<p>模型相关的概念在模型的类一节中进行介绍。</p>
<p>模型类 QAbstractItemModel 定义的访问数据接口 (函数) 是很灵活的，能够满足表格、列表和树用来显示模型的数据。然而，当给列表和表格自定义新的模型时，继承 QAbstractListModel 或者 QAbstractTableModel 是个很好的选择，因为他们提供了很多通用操作的默认实现，就不需要我们再重复实现。</p>
<p>实现自定义模型在创建新的模型类一节中进行介绍。</p>
<p>Qt provides some ready-made models that can be used to handle items of data:</p>
<ul>
<li>QStringListModel is used to store a simple list of QString items.</li>
<li>QStandardItemModel manages more complex tree structures of items, each of which can contain arbitrary data.</li>
<li>QFileSystemModel provides information about files and directories in the local filing system.</li>
<li>QSqlQueryModel, QSqlTableModel, and QSqlRelationalTableModel are used to access databases using model/view conventions.</li>
</ul>
<p>If these standard models do not meet your requirements, you can subclass QAbstractItemModel, QAbstractListModel, or QAbstractTableModel to create your own custom models.</p>
<p>Qt 已经提供了一些可用于处理数据项的模型:</p>
<ul>
<li>QStringListModel 用于存储简单的列表数据，数据项为 QString</li>
<li>QStandardItemModel 用于管理有树结构关系的数据项，每个数据项可以包含任意的数据</li>
<li>QFileSystemModel 访问本地文件系统的文件和文件夹</li>
<li>QSqlQueryModel, QSqlTableModel 和 QSqlRelationalTableModel 使用模型视图的方式访问数据库</li>
</ul>
<p>如果这些标准的模型还不能满足我们的需求，可以继承 QAbstractItemModel, QAbstractListModel, or QAbstractTableModel 实现自定义的模型类。</p>

        
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Qt/" rel="tag">Qt</a></li></ul>
	</div>


      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  

</article>





  
    <!-- 生成目录 -->


<article id="post-qtbook-custom-widget-group" class="article article-type-post" itemscope itemprop="blogPost">
    <!--  -->

    
        <div class="article-meta">
            <a href="/qtbook-custom-widget-group/" class="article-date">
  	<!-- <time datetime="2018-07-08T09:21:24.000Z" itemprop="datePublished">2018-07-08</time> -->
    2018-07-08
</a>

        </div>
    

    
        <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/qtbook-custom-widget-group/">分组布局</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
        
            <p>在进行界面布局的时候，常把控件根据功能分组放在一起，最常用的就是使用 QGroupBox 来放置一组控件。QGroupBox 虽然使用起来很方便，但就是有点丑，在要求较高的设计中，还得使用控件组合加自定义绘图或者 QSS 等才能实现，例如下面这个软件界面，直接使用 Qt 提供的控件是满足不了的:</p>
<p><img src="../img/qtbook/custom-widget/group-effect.png"></p>
<p>上图中分组的布局没有使用 QGroupBox，而是用几个控件组合起来实现的，设计如下:</p>
<p><img src="../img/qtbook/custom-widget/group-design.png"></p>
        
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/QtBook/" rel="tag">QtBook</a></li></ul>
	</div>


      

      
        <p class="article-more-link">
          <a  href="/qtbook-custom-widget-group/#more">阅读全文</a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  

</article>





  
    <!-- 生成目录 -->


<article id="post-qtbook-custom-widget-abnormity-buttons" class="article article-type-post" itemscope itemprop="blogPost">
    <!--  -->

    
        <div class="article-meta">
            <a href="/qtbook-custom-widget-abnormity-buttons/" class="article-date">
  	<!-- <time datetime="2018-06-21T03:45:06.000Z" itemprop="datePublished">2018-06-21</time> -->
    2018-06-21
</a>

        </div>
    

    
        <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/qtbook-custom-widget-abnormity-buttons/">异形按钮组</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
        
            <p>不少软件里看到过如下的按钮组，有 5 个按钮，中间 1 个，上下左右各一个：</p>
<p><img src="../img/qtbook/custom-widget/abnormity-button.png"></p>
<p>可以通过绘图的方式实现：计算每一个按钮的位置、大小、图片、点击的时候判断点击到了哪个按钮然后刷新绘制它的样式，并调用相应的函数执行点击操作，难度还是相当大的。
        
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/QtBook/" rel="tag">QtBook</a></li></ul>
	</div>


      

      
        <p class="article-more-link">
          <a  href="/qtbook-custom-widget-abnormity-buttons/#more">阅读全文</a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  

</article>





  
    <!-- 生成目录 -->


<article id="post-qtbook-paint-image" class="article article-type-post" itemscope itemprop="blogPost">
    <!--  -->

    
        <div class="article-meta">
            <a href="/qtbook-paint-image/" class="article-date">
  	<!-- <time datetime="2018-06-03T14:03:39.000Z" itemprop="datePublished">2018-06-03</time> -->
    2018-06-03
</a>

        </div>
    

    
        <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/qtbook-paint-image/">操作图像像素，实现各种效果</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
        
            <p>Qt 中图像相关的类主要是 QPixmap 和 QImage，QPixmap 没有提供访问图像像素数据的接口，访问图像的像素数据需要使用 QImage，主要的函数有 (相关重载函数没有列出来):</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取图像的像素数据</span></span><br><span class="line"><span class="function">QRgb   <span class="title">pixel</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">QColor <span class="title">pixelColor</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">uchar* <span class="title">scanLine</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// 设置图像的像素数据</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setPixel</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, uint index_or_rgb)</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setPixelColor</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">const</span> QColor &amp;color)</span></span></span><br></pre></td></tr></table></figure>

<p>下面把一个图像转为灰度图为例介绍怎么操作图像的像素:</p>
<ol>
<li>取得图像的宽、高</li>
<li>根据宽、高遍历每一个像素</li>
<li>得到每一个像素的 RGBA 颜色分量</li>
<li>对得到的颜色分量 RGBA 进行灰度计算得到新的颜色</li>
<li>使用计算得到的颜色设置对应像素
        
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/QtBook/" rel="tag">QtBook</a></li></ul>
	</div>


      

      
        <p class="article-more-link">
          <a  href="/qtbook-paint-image/#more">阅读全文</a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  

</article>





  
    <!-- 生成目录 -->


<article id="post-qtbook-custom-widget-group-buttons" class="article article-type-post" itemscope itemprop="blogPost">
    <!--  -->

    
        <div class="article-meta">
            <a href="/qtbook-custom-widget-group-buttons/" class="article-date">
  	<!-- <time datetime="2018-05-13T08:25:58.000Z" itemprop="datePublished">2018-05-13</time> -->
    2018-05-13
</a>

        </div>
    

    
        <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/qtbook-custom-widget-group-buttons/">自定义按钮组</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
        
            <p>如下的按钮组相信大家都看到过，最左和最右的按钮是圆角的，中间的按钮是矩形的，同时只能有一个按钮是选中状态：</p>
<p><img src="../img/qtbook/custom-widget/group-buttons-1.png"></p>
<p><img src="../img/qtbook/custom-widget/group-buttons-2.png"></p>
<p>按钮的样式使用 QSS 实现，使用 setProperty 设置按钮的 class 属性为 GroupButton，就可以利用类选择器 <code>.GroupButton</code> 选择按钮组的按钮，避免它们的样式影响到普通按钮。为了单独设置最左和最右按钮的样式，使用 setProperty 为其设置一个属性 position，最左按钮的为 first，最右按钮的为 last，然后就能使用属性选择器 <code>.GroupButton[position=&quot;first&quot;]</code> 和 <code>.GroupButton[position=&quot;last&quot;]</code> 选择它们了。
        
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/QtBook/" rel="tag">QtBook</a></li></ul>
	</div>


      

      
        <p class="article-more-link">
          <a  href="/qtbook-custom-widget-group-buttons/#more">阅读全文</a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  

</article>





  
    <!-- 生成目录 -->


<article id="post-spring-mvc-path-with-dot" class="article article-type-post" itemscope itemprop="blogPost">
    <!--  -->

    
        <div class="article-meta">
            <a href="/spring-mvc-path-with-dot/" class="article-date">
  	<!-- <time datetime="2018-05-04T02:07:12.000Z" itemprop="datePublished">2018-05-04</time> -->
    2018-05-04
</a>

        </div>
    

    
        <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/spring-mvc-path-with-dot/">SpringMVC 使用 @PathVariable 获取有 . 的 URL 中的变量</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
        
            <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/api/file/&#123;filename&#125;&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">foo</span><span class="params">(<span class="meta">@PathVariable</span> String filename)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> filename;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>默认配置时，不同的 URL ，获取到的 filename 为:</p>
<ul>
<li><code>/api/file/foo</code>，filename 为 foo</li>
<li><code>/api/file/foo.pdf</code>，filename 为 foo</li>
<li><code>/api/file/foo.pdf.png</code>，filename 为 foo.pdf</li>
<li><code>/api/file/foo.pdf.png.doc</code>，filename 为 foo.pdf.png</li>
</ul>
<p>最后一个 <code>.</code> 被截断了，解决这个问题有 2 中方法:</p>
<ul>
<li><p>使用正则表达式进行路径匹配，映射为：<code>@GetMapping(&quot;/api/file/&#123;filename:.+&#125;&quot;)</code></p>
<ul>
<li>缺点：每个路径的映射都要写一遍，不方便</li>
<li>优点：缺点也是优点，只影响需要的路径</li>
</ul>
</li>
<li><p>配置 <code>annotation-driven</code>，映射为：<code>@GetMapping(&quot;/api/file/&#123;filename&#125;&quot;)</code></p>
<ul>
<li>优点：只需要配置一次，整个应用都生效，方便</li>
<li>缺点：优点也是缺点，影响了整个系统，不过还没有发现对整个系统有什么副作用</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:path-matching</span> <span class="attr">registered-suffixes-only</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
        
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SpringMVC/" rel="tag">SpringMVC</a></li></ul>
	</div>


      

      
        <p class="article-more-link">
          <a  href="/spring-mvc-path-with-dot/#more">阅读全文</a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  

</article>





  
    <!-- 生成目录 -->


<article id="post-qtbook-custom-widget-tree-view" class="article article-type-post" itemscope itemprop="blogPost">
    <!--  -->

    
        <div class="article-meta">
            <a href="/qtbook-custom-widget-tree-view/" class="article-date">
  	<!-- <time datetime="2018-04-24T13:41:39.000Z" itemprop="datePublished">2018-04-24</time> -->
    2018-04-24
</a>

        </div>
    

    
        <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/qtbook-custom-widget-tree-view/">QTreeView 小集</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
        
            <p>树形控件是非常常用的，例如组织结构、目录树、省市县的地区结构等都是典型的树形结构，Qt 里可以使用 QTreeView 和 QTreeWidget 来展示树形结构，这里我们只介绍 QTreeView 的使用，QTreeView 本身只用于树的显示，树的数据由 QStandardItemModel 来存储。</p>
<h2 id="创建单列树"><a href="#创建单列树" class="headerlink" title="创建单列树"></a>创建单列树</h2><p>创建单列树的节点分两种情况：</p>
<ul>
<li>创建第一级节点调用函数 <code>QStandardItemModel::appendRow(QStandardItem *item)</code></li>
<li>创建第二级、第三级等非第一级节点调用函数 <code>QStandardItem::(QStandardItem *item)</code></li>
</ul>
<p>下面的例子创建省市县的树形结构展示如何创建只有一列的树，为了更好的从变量名上看出地区的关系，使用数字和层级的方式进行命名，程序运行结果如下：</p>
<p><img src="../img/qtbook/custom-widget/region-1.png">
        
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/QtBook/" rel="tag">QtBook</a></li></ul>
	</div>


      

      
        <p class="article-more-link">
          <a  href="/qtbook-custom-widget-tree-view/#more">阅读全文</a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  

</article>





  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/9/">⇠ Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><a class="page-number" href="/page/12/">12</a><span class="space">&hellip;</span><a class="page-number" href="/page/49/">49</a><a class="extend next" rel="next" href="/page/11/">Next ⇢</a>
    </nav>
  

</div>
            <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <p>Hosted by <a target="_blank" rel="noopener" href="https://github.com">Github Pages</a></p>
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> Mod
            </div>
        </div>

        <!-- 卜算子 -->
        
    </div>
</footer>

        </div>
        

<script>
	var yiliaConfig = {
		fancybox: false,
		mathjax: false,
		animate: false,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<!-- 
<script src="/js/main.js"></script>
 -->

<!--



 -->

<script>
  if (window.mermaid) {
    mermaid.initialize({
		securityLevel: 'loose',
		theme: 'dark',
	});
  }
</script>

    </div>
</body>

</html>
